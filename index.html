<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>오봉초등학교 면접 타이머</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap');

        :root {
            --primary-color: #0056b3;
            --warning-bg: #fff3cd;
            --warning-text: #856404;
            --danger-bg: #f8d7da;
            --danger-text: #721c24;
            --bg-color: #ffffff;
            --text-color: #333333;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.5s ease, color 0.5s ease;
            overflow: hidden;
        }

        /* 컨테이너: 화면 전체 활용 및 여백 추가 */
        .container {
            text-align: center;
            width: 95%;
            height: 100%; /* 화면 높이 전체 사용 */
            padding: 5vh 0; /* 위아래 여백 추가 (화면 높이의 5%) */
            box-sizing: border-box; /* 패딩을 포함한 크기 계산 */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 15px;
            background-color: transparent; 
        }

        /* 헤더 영역 (로고 + 제목) */
        .header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 2vh;
            flex-shrink: 0; /* 공간 부족해도 줄어들지 않음 */
        }

        .logo {
            height: 80px; /* 로고 높이 고정 */
            width: auto;
        }

        h1 {
            font-size: 3rem; /* 제목 크기 */
            margin: 0;
            font-weight: 700;
            color: #333;
            white-space: nowrap; /* 줄바꿈 방지 */
        }

        /* 타이머 숫자: 화면 가득 채우기 (여백 고려하여 크기 조정) */
        #timer-display {
            font-size: 30vw; /* 35vw -> 30vw로 약간 축소하여 여백 확보 */
            font-weight: 700;
            line-height: 1.2; /* 줄 간격을 1.2로 늘려 글자 잘림 방지 */
            margin: 0;
            font-variant-numeric: tabular-nums;
            letter-spacing: -5px;
            color: var(--primary-color);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        /* 버튼 그룹 */
        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 3vh;
            flex-shrink: 0;
        }

        button {
            padding: 15px 30px;
            font-size: 1.5rem; /* 버튼 글자 크기 확대 */
            font-family: 'Noto Sans KR', sans-serif;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: transform 0.1s, background-color 0.2s;
            font-weight: bold;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        button:active {
            transform: scale(0.95);
        }

        .btn-start {
            background-color: #28a745;
            color: white;
        }
        .btn-start:hover { background-color: #218838; }

        .btn-pause {
            background-color: #ffc107;
            color: #333;
            display: none;
        }
        .btn-pause:hover { background-color: #e0a800; }

        .btn-reset {
            background-color: #6c757d;
            color: white;
        }
        .btn-reset:hover { background-color: #5a6268; }

        .btn-test {
            background-color: #17a2b8;
            color: white;
            font-size: 1.2rem;
            padding: 15px 20px;
        }
        .btn-test:hover { background-color: #138496; }

        /* 상태별 스타일 */
        body.warning {
            background-color: var(--warning-bg);
        }
        body.warning h1 {
            color: var(--warning-text);
        }
        body.warning #timer-display {
            color: var(--warning-text);
        }

        body.ended {
            background-color: var(--danger-bg);
        }
        body.ended h1 {
            color: var(--danger-text);
        }
        body.ended #timer-display {
            color: var(--danger-text);
        }
        
        .status-message {
            margin-top: 2vh;
            font-size: 1.5rem;
            font-weight: 500;
            color: #555;
            min-height: 40px;
        }
        
        /* 모바일 등 작은 화면 대응 */
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 10px;
            }
            h1 { font-size: 1.8rem; }
            .logo { height: 60px; }
            #timer-display { font-size: 28vw; }
            button { padding: 10px 20px; font-size: 1.2rem; }
        }

    </style>
</head>
<body>

    <div class="container">
        <div class="header">
            <!-- 요청하신 오봉초등학교 로고 -->
            <img src="https://folio.itt.link/attachfiles/upload/board/SITE_000000000000001/323/BBSMSTR_000003234647/FILE_000000005901857_1" alt="오봉초등학교 로고" class="logo">
            <h1>오봉초등학교 공모교장 면접</h1>
        </div>
        
        <div id="timer-display">05:00</div>
        
        <div class="status-message" id="statusMsg">준비됨</div>

        <div class="controls">
            <button class="btn-start" onclick="startTimer()" id="startBtn">시작</button>
            <button class="btn-pause" onclick="pauseTimer()" id="pauseBtn">일시정지</button>
            <button class="btn-reset" onclick="resetTimer()">초기화</button>
            <!-- 테스트용 버튼 -->
            <button class="btn-test" onclick="jumpToOneMinute()">1분 남음 테스트</button>
        </div>
    </div>

    <script>
        let timeLeft = 300; // 5분 = 300초
        let timerInterval = null;
        let isRunning = false;
        const initialTime = 300;
        
        // 알림음 오디오 객체 생성
        const soundUrl = 'https://folio.itt.link/cmm/fms/FileDown.do?atchFileId=FILE_000000006382937&fileSn=1&nttNo=6982186';
        const alertAudio = new Audio(soundUrl);
        alertAudio.preload = 'auto'; // 미리 로드

        // 오디오 재생 타이머 (setTimeout 저장용)
        let soundTimeout = null;

        function playAlertSound(type) {
            // 재생 전 기존 소리 정지 및 초기화
            alertAudio.pause();
            alertAudio.currentTime = 0;
            if (soundTimeout) {
                clearTimeout(soundTimeout);
                soundTimeout = null;
            }

            let duration = 0; // 재생 시간 (밀리초)

            if (type === 'warning') {
                duration = 2000; // 1분 남았을 때: 2초
            } else if (type === 'end') {
                duration = 5000; // 종료 시: 5초
            }

            // 소리 재생
            alertAudio.play().then(() => {
                // 지정된 시간 후 정지
                soundTimeout = setTimeout(() => {
                    alertAudio.pause();
                    alertAudio.currentTime = 0;
                }, duration);
            }).catch(error => {
                console.error("오디오 재생 실패 (브라우저 정책 확인 필요):", error);
            });
        }

        function updateDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            const displayStr = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            document.getElementById('timer-display').innerText = displayStr;
            
            document.body.classList.remove('warning', 'ended');

            if (timeLeft === 0) {
                document.body.classList.add('ended');
                document.getElementById('statusMsg').innerText = "면접 시간이 종료되었습니다.";
            } else if (timeLeft <= 60) {
                document.body.classList.add('warning');
                document.getElementById('statusMsg').innerText = "마무리 발언 시간입니다. (1분 미만)";
            } else {
                document.getElementById('statusMsg').innerText = isRunning ? "면접 진행 중..." : "일시정지됨";
            }
        }

        function startTimer() {
            if (isRunning) return;
            
            // 모바일 브라우저 등에서 오디오 권한 확보를 위해 시작 시 로드 시도
            alertAudio.load();

            isRunning = true;
            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('pauseBtn').style.display = 'inline-block';
            document.getElementById('statusMsg').innerText = "면접 진행 중...";

            timerInterval = setInterval(() => {
                if (timeLeft > 0) {
                    timeLeft--;
                    updateDisplay();
                    
                    if (timeLeft === 60) {
                        playAlertSound('warning'); // 1분 남음: 2초 재생
                    }
                    if (timeLeft === 0) {
                        playAlertSound('end'); // 종료: 5초 재생
                        clearInterval(timerInterval);
                        isRunning = false;
                        document.getElementById('startBtn').style.display = 'inline-block';
                        document.getElementById('pauseBtn').style.display = 'none';
                    }
                }
            }, 1000);
        }

        function pauseTimer() {
            clearInterval(timerInterval);
            isRunning = false;
            document.getElementById('startBtn').style.display = 'inline-block';
            document.getElementById('pauseBtn').style.display = 'none';
            document.getElementById('statusMsg').innerText = "일시정지됨";
            
            // 일시정지 시 소리도 멈춤
            alertAudio.pause();
            alertAudio.currentTime = 0;
            if (soundTimeout) clearTimeout(soundTimeout);
        }

        function resetTimer() {
            pauseTimer();
            timeLeft = initialTime;
            updateDisplay();
            document.getElementById('statusMsg').innerText = "준비됨";
            document.body.className = '';
        }

        function jumpToOneMinute() {
            // 테스트 시 오디오 로드
            alertAudio.load();
            
            pauseTimer();
            timeLeft = 60;
            updateDisplay();
            playAlertSound('warning'); // 테스트 시에도 2초 재생 확인
            document.getElementById('statusMsg').innerText = "테스트: 1분 시점으로 이동했습니다.";
        }

        updateDisplay();
        document.getElementById('statusMsg').innerText = "준비됨";
    </script>
</body>
</html>
